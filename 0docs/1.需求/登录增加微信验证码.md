#### 【登录支持微信验证码】 开发计划
开发计划


任务安排(工时都是开发时间)

##### 1、用户权限系统(mgrserver)

###### 1.1 后台管理 (PC)
编号|子系统|模块|任务名称|负责人|工时
|--|:--|:--|:--|:--|:--|:--|
|1|用户权限系统|用户管理|在用户列表中展示绑定按钮(绑定过的不用展示)|张晓辉|1
|2|用户权限系统|用户管理|生成二维码所要的相关信息(user_id,时间戳,加密串)|张晓辉|2
|3|用户权限系统|用户管理|前台生成二维码并弹框展示|张晓辉|1


##### 2、登录系统(loginserver)

###### 2.1 绑定用户-新增 (手机)
编号|子系统|模块|任务名称|负责人|工时
|--|:--|:--|:--|:--|:--|:--|
|1|登录系统|绑定微信|绑定页面api 验证签名、user_id合法性，时间是否过期|张晓辉|2.5
|2|登录系统|绑定微信|构造数据调用微信api接口,appid,secrect,微信返回state|张晓辉|2
|3|登录系统|绑定微信|微信回调页面，验证,获取openid并保存到数据库|张晓辉|2
|4|登录系统|绑定微信|信息提示页面(正常或者错误信息提示)|张晓辉|0.5


###### 2.2 用户名、密码、验证码登录 (PC) ---登录方案1
编号|子系统|模块|任务名称|负责人|工时
|--|:--|:--|:--|:--|:--|
|1|登录系统|登录|验证用户是否绑定微信,未绑定直接提示先去绑定，绑定过就生成用户验证码,保存到redis中|张晓辉|2
|2|登录系统|登录|获取微信access_token, 调用微信接口,发送微信验证码,这个还要研究接口 |张晓辉|3
|3|登录系统|登录|用户验证码输入错误次数的处理, 现在处理成可以输错4次,第⑤次错误后只有重新发送验证码|张晓辉|2
|4|登录系统|登录|新增登录验证redis中存的验证码|张晓辉|0.5
|4|登录系统|其他|增加模板信息(需要申请)|xxx|未知

###### 2.3 扫码登录 (PC, 手机) ---登录方案2
编号|子系统|模块|任务名称|负责人|工时
|--|:--|:--|:--|:--|:--|
|1|登录系统|登录|PC 登录页面布局、样式调整,能显示二维码|xxx|未知
|2|登录系统|登录|PC 服务端生成登录二维码数据(登录标识、url地址),登录标识存于redis|张晓辉|1
|3|登录系统|登录|手机 微信扫码后,手机确认登录页面样式(新增)|xxx|未知
|3|登录系统|登录|调用微信api接口获取用户openid, 验证openid是否已关联用户，否则直接提示用户先去绑定用户(手机上), 验证通过后保存openid到登录标识中, 手机跳转到确认成功页面|张晓辉|3
|4|登录系统|登录|PC 前端ajax调用api,获取手机确认情况, 通过openid查找对应的用户, 验证系统状态，用户状态，以及权限,都通过后算登录成功|张晓辉|3.5
|4|登录系统|登录|前端二维码过期(5分钟),过期后不在调用api(验证用户是否手机登录确认),前端提示用户刷新重新生成二维码|张晓辉|1
